(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[224],{71550:function(se,M,r){"use strict";r.d(M,{Z:function(){return l}});var u=r(11849),x=r(93224),H=r(67294),Z=r(952),R=r(37476),E=r(71975),K=r(2824),Y=r(61193),j=r.n(Y),V=r(85893),_=["title","modalProps","children"],d=function(e){var F=(0,H.useState)(!1),p=(0,K.Z)(F,2),A=p[0],P=p[1],te=(0,H.useState)(),B=(0,K.Z)(te,2),q=B[0],$=B[1],b=H.createRef(),L=e.title,oe=e.modalProps,W=e.children,ce=(0,x.Z)(e,_),z=function(U,k){var C,I=window.document.documentElement,ne=I.clientWidth,ae=I.clientHeight,a=b==null||(C=b.current)===null||C===void 0?void 0:C.getBoundingClientRect();!a||$({left:-a.left+k.x,right:ne-(a.right-k.x),top:-a.top+k.y,bottom:ae-(a.bottom-k.y)})};return(0,V.jsx)(R.Y,(0,u.Z)((0,u.Z)({title:(0,V.jsx)("div",{style:{width:"100%",cursor:"move"},onMouseOver:function(){A&&P(!1)},onMouseOut:function(){P(!0)},onFocus:function(){},onBlur:function(){},children:L})},ce),{},{modalProps:{modalRender:function(U){return(0,V.jsx)(j(),{disabled:A,bounds:q,onStart:function(C,I){return z(C,I)},children:(0,V.jsxs)("div",{ref:b,children:[" ",U," "]})})}},children:W}))},h=d,v=["formType","isAdd","children","title"],f=function(e){var F={ProForm:Z.ZP,YuDraggleModal:h,ModalForm:R.Y,DrawerForm:E.a},p=e==null?void 0:e.layout;p=p||"horizontal";var A=p==="horizontal"?{labelCol:{span:5},wrapperCol:{span:19}}:{},P=e!=null&&e.formType?F[e==null?void 0:e.formType]:F.YuDraggleModal,te=e.formType,B=e.isAdd,q=e.children,$=e.title,b=(0,x.Z)(e,v);return(0,V.jsx)(P,(0,u.Z)((0,u.Z)((0,u.Z)({title:$,layout:p},A),b),{},{children:q}))},l=f},9266:function(se,M,r){"use strict";r.r(M),r.d(M,{default:function(){return Ee}});var u=r(39428),x=r(3182),H=r(59250),Z=r(13013),R=r(30887),E=r(28682),K=r(32157),Y=r(7573),j=r(2824),V=r(47673),_=r(4107),d=r(67294),h=r(57895),v=r(44545),f=r(36061),l=r(45254),g=r(90102),e=r(75159),F=r(11849),p=r(93224),A=r(71550),P=(0,l.Ui)("/virtualDept");function te(s){return B.apply(this,arguments)}function B(){return B=_asyncToGenerator(_regeneratorRuntime().mark(function s(i){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",YuApi.queryPage(P,i));case 1:case"end":return t.stop()}},s)})),B.apply(this,arguments)}function q(s,i){return $.apply(this,arguments)}function $(){return $=_asyncToGenerator(_regeneratorRuntime().mark(function s(i,y){return _regeneratorRuntime().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",YuApi.getById(i,P).then(function(N){return y(N)}));case 1:case"end":return m.stop()}},s)})),$.apply(this,arguments)}function b(s){return L.apply(this,arguments)}function L(){return L=(0,x.Z)((0,u.Z)().mark(function s(i){return(0,u.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",g.Vx(P,i));case 1:case"end":return t.stop()}},s)})),L.apply(this,arguments)}function oe(s){return W.apply(this,arguments)}function W(){return W=(0,x.Z)((0,u.Z)().mark(function s(i){return(0,u.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",g.IH(i,P));case 1:case"end":return t.stop()}},s)})),W.apply(this,arguments)}function ce(s){return z.apply(this,arguments)}function z(){return z=_asyncToGenerator(_regeneratorRuntime().mark(function s(i){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",YuApi.deleteById(i,P));case 1:case"end":return t.stop()}},s)})),z.apply(this,arguments)}function O(s){return U.apply(this,arguments)}function U(){return U=_asyncToGenerator(_regeneratorRuntime().mark(function s(i){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",YuApi.update("".concat(P,"/").concat(i,"/enable")));case 1:case"end":return t.stop()}},s)})),U.apply(this,arguments)}function k(s){return C.apply(this,arguments)}function C(){return C=_asyncToGenerator(_regeneratorRuntime().mark(function s(i){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",YuApi.update("".concat(P,"/").concat(i,"/disable")));case 1:case"end":return t.stop()}},s)})),C.apply(this,arguments)}var I=r(5966),ne=r(31199),ae=r(54618),a=r(85893),Se=["pDept"],Fe=function(i){var y,t,m=i.pDept,N=(0,p.Z)(i,Se);return console.log("pDept",m),(0,a.jsxs)(A.Z,(0,F.Z)((0,F.Z)({},N),{},{title:"\u65B0\u5EFA\u865A\u62DF\u90E8\u95E8",width:"500px",onFinish:function(){var ee=(0,x.Z)((0,u.Z)().mark(function re(J){var Q,G;return(0,u.Z)().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(Q=(0,F.Z)((0,F.Z)({},i.initialValues),J),J.id){T.next=7;break}return T.next=4,e.ii(Q,oe);case 4:G=T.sent,T.next=10;break;case 7:return T.next=9,e.He(Q,b);case 9:G=T.sent;case 10:G&&i.onFinish&&i.onFinish(J);case 11:case"end":return T.stop()}},re)}));return function(re){return ee.apply(this,arguments)}}(),children:[(0,a.jsx)(I.Z,{rules:[{required:!0,message:"\u540D\u79F0\u79F0\u4E3A\u5FC5\u586B\u9879"}],fieldProps:{maxLength:20},label:"\u540D\u79F0",name:"name"}),(0,a.jsxs)(I.Z,{label:"\u6240\u5C5E\u90E8\u95E8",readonly:!0,children:[(0,a.jsx)(ae.Z,{})," ",((y=i.pDept)===null||y===void 0?void 0:y.name)||((t=i.pDept)===null||t===void 0?void 0:t.title)]}),(0,a.jsx)(ne.Z,{rules:[{required:!0,message:"\u6392\u5E8F\u4E3A\u5FC5\u586B\u9879"}],label:"\u6392\u5E8F",name:"sort",min:1,max:99})]}))},de=Fe,Te=r(952),Ce=r(78009),Re=r(85224),be=_.Z.Search,Je=function s(i){var y=[];return Array.isArray(i)&&(i==null||i.forEach(function(t){var m={};m.key=t.id,m.value=t.id,m.title=t.name,m.children=t.children?s(t.children):[],y.push(m)})),y},we=function(){var i=(0,d.useState)(!1),y=(0,j.Z)(i,2),t=y[0],m=y[1],N=(0,d.useState)([]),ee=(0,j.Z)(N,2),re=ee[0],J=ee[1],Q=(0,d.useState)(),G=(0,j.Z)(Q,2),pe=G[0],T=G[1],Ve=(0,d.useState)(),he=(0,j.Z)(Ve,2),ve=he[0],fe=he[1],Ae=(0,d.useState)(null),me=(0,j.Z)(Ae,2),X=me[0],Be=me[1],$e=(0,d.useState)(null),ge=(0,j.Z)($e,2),Ie=ge[0],Me=ge[1],Ye=(0,d.useState)(!1),ye=(0,j.Z)(Ye,2),Oe=ye[0],ue=ye[1],Ue=(0,d.useState)([]),Ze=(0,j.Z)(Ue,2),De=Ze[0],ie=Ze[1],ke=(0,d.useState)(),xe=(0,j.Z)(ke,2),je=xe[0],Ge=xe[1],He=function(){g.et((0,l.Ui)("/dept/tree")).then(function(n){Ge(Pe(n==null?void 0:n.data))})},le=function(){g.et((0,l.Ui)("/virtualDept/tree")).then(function(n){J(n.data),T(Pe(n.data))})};(0,d.useEffect)(function(){He(),le()},[]);var Ke=Y.Z.DirectoryTree,Pe=function o(n){var c=[];return Array.isArray(n)&&(n==null||n.forEach(function(D){var S={};S.pid=D.pid,S.key=D.id,S.value=D.id,S.title=D.name,S.children=D.children?o(D.children):[],c.push(S)})),c},Le=function(n){ue(!1),ie([]),g.et((0,l.Ui)("/virtualDept/".concat(n.key,"/deptIds"))).then(function(c){return ie(c)})};function We(o){switch(o.key){case"1":fe("A"),m(!0);break;case"2":fe("U"),m(!0)}}var ze=function(n){return(0,a.jsxs)(E.Z,{onClick:function(D){D.domEvent.stopPropagation(),We(D)},children:[n.pid!=="0"&&(0,a.jsx)(E.Z.Item,{children:n.key==="1"?"\u65B0\u5EFA\u865A\u62DF\u7EC4\u7EC7":"\u65B0\u5EFA\u865A\u62DF\u90E8\u95E8"},"1"),(0,a.jsx)(E.Z.Item,{children:"\u4FEE\u6539\u4FE1\u606F"},"2")]})};return(0,a.jsxs)(Ce.ZP,{header:{breadcrumb:{}},children:[(0,a.jsx)(h.ZP,{split:"vertical",style:{height:"calc(100vh - 170px)"},children:(0,a.jsxs)(f.Z,{split:"vertical",defaultSize:300,minSize:300,maxSize:400,children:[(0,a.jsxs)("div",{style:{width:"100%"},children:[(0,a.jsx)("div",{style:{padding:"5px"},children:(0,a.jsx)(be,{placeholder:"\u67E5\u8BE2",onChange:function(){}})}),(0,a.jsx)("div",{style:{height:"calc(100% - 45px)",overflow:"auto"},children:(0,a.jsx)(Ke,{titleRender:function(n){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:n.title}),(0,a.jsx)("span",{className:"right",children:(0,a.jsx)(Z.Z,{menu:ze(n),trigger:["click"],placement:"bottomRight",children:(0,a.jsx)(v.Z,{onClick:function(D){Be(n),D.stopPropagation()}})})})]})},onClick:function(n,c){Me(c),Le(c)},defaultExpandedKeys:["0-0-0"],treeData:pe})})]}),(0,a.jsx)(h.ZP,{title:"\u6620\u5C04\u5173\u7CFB",headerBordered:!0,children:(0,a.jsx)("div",{style:{height:"calc(100% - 40px)",overflow:"auto"},children:(0,a.jsx)(Te.ZP,{submitter:{render:function(n,c){return Oe?(0,a.jsx)(Re.Z,{children:c}):null}},onFinish:function(){var o=(0,x.Z)((0,u.Z)().mark(function n(c){return(0,u.Z)().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,e.ii({deptIds:De},function(w){var Ne=w.deptIds;return g.IH({deptIds:Ne},(0,l.Ui)("/virtualDept/".concat(Ie.key,"/deptIds")))});case 2:ue(!1);case 3:case"end":return S.stop()}},n)}));return function(n){return o.apply(this,arguments)}}(),children:je&&(0,a.jsx)(Y.Z,{showIcon:!0,checkable:!0,defaultExpandAll:!0,treeData:je,onCheck:function(n,c){ue(!0),ie(n)},checkedKeys:De})})})})]})}),t&&ve==="A"&&(0,a.jsx)(de,{visible:t,onVisibleChange:function(n){n||m(!1)},onFinish:(0,x.Z)((0,u.Z)().mark(function o(){return(0,u.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:m(!1),le();case 2:case"end":return c.stop()}},o)})),initialValues:{pid:X.value},pDept:X}),t&&ve==="U"&&(0,a.jsx)(de,{visible:t,params:{id:X.value},request:function(){var o=(0,x.Z)((0,u.Z)().mark(function n(c){var D;return(0,u.Z)().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,g.FO(c.id,(0,l.Ui)("/virtualDept"));case 2:return D=w.sent,w.abrupt("return",Promise.resolve(D));case 4:case"end":return w.stop()}},n)}));return function(n){return o.apply(this,arguments)}}(),onVisibleChange:function(n){n||m(!1)},onFinish:(0,x.Z)((0,u.Z)().mark(function o(){return(0,u.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:m(!1),le();case 2:case"end":return c.stop()}},o)})),initialValues:{pid:X.pid},pDept:re.find(function(o){return o.id===X.pid})})]})},Ee=we},75159:function(se,M,r){"use strict";r.d(M,{pr:function(){return E},ii:function(){return K},He:function(){return Y},fn:function(){return j}});var u=r(39428),x=r(11849),H=r(34792),Z=r(48086),R=r(3182),E=function(){var d=(0,R.Z)((0,u.Z)().mark(function h(v,f){var l,g,e=arguments;return(0,u.Z)().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return l=e.length>2&&e[2]!==void 0?e[2]:"\u5904\u7406",g=Z.ZP.loading("\u6B63\u5728".concat(l)),p.prev=2,g(),p.next=6,f((0,x.Z)({},v));case 6:return Z.ZP.success("".concat(l,"\u6210\u529F")),p.abrupt("return",!0);case 10:return p.prev=10,p.t0=p.catch(2),Z.ZP.error("".concat(l,"\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01")),p.abrupt("return",!1);case 14:case"end":return p.stop()}},h,null,[[2,10]])}));return function(v,f){return d.apply(this,arguments)}}(),K=function(){var d=(0,R.Z)((0,u.Z)().mark(function h(v,f){var l;return(0,u.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=Z.ZP.loading("\u6B63\u5728\u6DFB\u52A0"),e.prev=1,l(),e.next=5,f((0,x.Z)({},v));case 5:return Z.ZP.success("\u6DFB\u52A0\u6210\u529F"),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(1),Z.ZP.error("\u6DFB\u52A0\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01"),e.abrupt("return",!1);case 13:case"end":return e.stop()}},h,null,[[1,9]])}));return function(v,f){return d.apply(this,arguments)}}(),Y=function(){var d=(0,R.Z)((0,u.Z)().mark(function h(v,f){var l;return(0,u.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=Z.ZP.loading("\u6B63\u5728\u66F4\u65B0"),e.prev=1,l(),e.next=5,f((0,x.Z)({},v));case 5:return Z.ZP.success("\u66F4\u65B0\u6210\u529F"),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(1),Z.ZP.error("\u66F4\u65B0\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01"),e.abrupt("return",!1);case 13:case"end":return e.stop()}},h,null,[[1,9]])}));return function(v,f){return d.apply(this,arguments)}}(),j=function(){var d=(0,R.Z)((0,u.Z)().mark(function h(v,f){var l;return(0,u.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l=Z.ZP.loading("\u6B63\u5728\u5220\u9664"),f){e.next=3;break}return e.abrupt("return",!0);case 3:return e.prev=3,l(),e.next=7,v(f);case 7:return Z.ZP.success("\u5220\u9664\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"),e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(3),Z.ZP.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),e.abrupt("return",!1);case 15:case"end":return e.stop()}},h,null,[[3,11]])}));return function(v,f){return d.apply(this,arguments)}}(),V=null,_=null}}]);
