(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[298],{33107:function(B,y,e){"use strict";var T=e(86582),o=e(2824),r=e(67294),f=e(6934),m=e(60171),E=e(24557),_=e(49e3),p=e(50208),P=e(45254),O=e(90102),a=e(85893),M=function g(i){var u=[];return Array.isArray(i)&&(i==null||i.forEach(function(s){var l={};s.id==="0"?l.icon=(0,a.jsx)(E.Z,{}):l.icon=(0,a.jsx)(_.Z,{}),l.key=s.id,l.value=s.id,l.name=s.name,l.title=s.name,l.deptTypeId=s.typeId,l.children=s.children?g(s.children):[],u.push(l)})),u},D=function g(i,u){for(var s,l=0;l<u.length;l++){var t=u[l];t.children&&(t.children.some(function(j){return j.key===i})?s=t.key:g(i,t.children)&&(s=g(i,t.children)))}return s},I=function(i){var u=(0,p.tT)("@@initialState"),s=u.initialState,l=s||{},t=l.currentUser,j=(0,r.useState)(t==null?void 0:t.deptId),L=(0,o.Z)(j,2),W=L[0],R=L[1],F=(0,r.useState)({id:t==null?void 0:t.deptId,name:t==null?void 0:t.deptName,typeId:t==null?void 0:t.deptTypeId}),C=(0,o.Z)(F,2),K=C[0],Z=C[1],A=(0,r.useState)(),V=(0,o.Z)(A,2),U=V[0],w=V[1],q=(0,r.useState)([]),z=(0,o.Z)(q,2),G=z[0],ee=z[1],te=(0,r.useState)([t==null?void 0:t.deptId]),H=(0,o.Z)(te,2),ne=H[0],N=H[1],ae=(0,r.useState)(""),J=(0,o.Z)(ae,2),b=J[0],re=J[1],le=(0,r.useState)(!0),Q=(0,o.Z)(le,2),oe=Q[0],X=Q[1];(0,r.useEffect)(function(){ie()},[]);var ie=function(){O.et((0,P.Ui)("/dept/tree")).then(function(n){if(n!=null&&n.data){var d=M(n==null?void 0:n.data);w(d),ue(n==null?void 0:n.data),i.onInit&&i.onInit(d)}})},ue=function x(n){for(var d=function(h){var S=n[h];ee(function(Y){return[].concat((0,T.Z)(Y),[{key:S.id,title:S.name}])}),S.children&&x(S.children)},v=0;v<n.length;v++)d(v)},se=function(n){N(n),X(!1)},de=function(n){var d=n.target.value;if(d){var v=G==null?void 0:G.map(function(c){var h;return((h=String(c==null?void 0:c.title))===null||h===void 0?void 0:h.indexOf(d))>-1?D(c.key,U):null}).filter(function(c,h,S){return c&&S.indexOf(c)===h});N(v.length>0?v:[t==null?void 0:t.deptId]),re(d),X(!0)}else N([t==null?void 0:t.deptId])},$=(0,r.useMemo)(function(){var x=function n(d){return d.map(function(v){var c=v.title,h=c.indexOf(b),S=c.substring(0,h),Y=c.slice(h+b.length),k=h>-1?(0,a.jsxs)("span",{children:[S,(0,a.jsx)("span",{style:{color:"#f50"},children:b}),Y]}):(0,a.jsx)("span",{children:c}),_e=v.key==="0"?(0,a.jsx)(E.Z,{}):(0,a.jsx)(_.Z,{});return v.children?{title:k,icon:_e,key:v.key,children:n(v.children)}:{title:k,key:v.key,icon:(0,a.jsx)(E.Z,{})}})};return U?x(U):null},[b]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.default,{style:{marginBottom:8},placeholder:"\u90E8\u95E8\u641C\u7D22",onChange:de}),U&&(0,a.jsx)(m.Z,{showIcon:!0,onExpand:se,blockNode:!0,expandedKeys:ne,autoExpandParent:oe,style:{fontSize:"16px"},defaultSelectedKeys:[t==null?void 0:t.deptId],treeData:$||U,selectedKeys:[W],onSelect:function(n,d){n[0]&&(R(n[0]),Z({id:d.node.key,name:d.node.title,typeId:d.node.deptTypeId}),i.onSelect(n[0]))}})]})};y.Z=I},35468:function(B,y,e){"use strict";var T=e(11849),o=e(2824),r=e(40759),f=e(57895),m=e(78009),E=e(33107),_=e(67294),p=e(62586),P=e(85893);function O(a){var M=(0,_.useState)(),D=(0,o.Z)(M,2),I=D[0],g=D[1],i=(0,_.useState)(),u=(0,o.Z)(i,2),s=u[0],l=u[1],t=(0,_.useRef)(),j=(0,_.useState)(""),L=(0,o.Z)(j,2),W=L[0],R=L[1];(0,_.useEffect)(function(){R((0,p.W)())},[]);var F=a.showDeptTree===void 0?!0:a.showDeptTree;return(0,P.jsx)(m.ZP,{header:{breadcrumb:{}},children:(0,P.jsxs)(f.ZP,{split:"vertical",ghost:!0,children:[F&&(0,P.jsx)(f.ZP,{style:{height:"calc(100vh - 168px)",background:"white"},colSpan:{xs:12,sm:12,md:10,lg:8,xl:5},children:(0,P.jsx)(E.Z,{onInit:function(K){l(K)},onSelect:function(K){if(g(K),a.tableProps.actionRef){var Z;(Z=a.tableProps.actionRef.current)===null||Z===void 0||Z.reload()}else{var A;(A=t.current)===null||A===void 0||A.reload()}}})}),(0,P.jsx)(f.ZP,{ghost:!0,children:(0,P.jsx)(r.ZP,(0,T.Z)({tableLayout:"fixed",rowKey:"id",search:{labelWidth:120,onCollapse:function(){R((0,p.W)())}},actionRef:t,params:(0,T.Z)({deptId:I},a.tableProps.params),scroll:{y:W,x:"1000px"},pagination:{showSizeChanger:!0}},a.tableProps))})]})})}y.Z=O},83965:function(B,y,e){"use strict";e.r(y),e.d(y,{default:function(){return M}});var T=e(67294),o=e(39428),r=e(3182),f=e(90102),m=e(45254),E=(0,m.Ui)("/logLogin");function _(D,I){return p.apply(this,arguments)}function p(){return p=(0,r.Z)((0,o.Z)().mark(function D(I,g){return(0,o.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",f.LV(E,I,g));case 1:case"end":return u.stop()}},D)})),p.apply(this,arguments)}var P=e(35468),O=e(85893),a=function(){var I=[{title:"\u767B\u5F55\u7528\u6237",align:"center",dataIndex:"username",sorter:!0},{title:"\u6240\u5C5E\u90E8\u95E8",dataIndex:"deptName",search:!1},{title:"IP",align:"center",dataIndex:"ip"},{title:"\u767B\u5F55\u5730\u5740",align:"center",dataIndex:"location"},{title:"\u6D4F\u89C8\u5668",align:"center",dataIndex:"browser"},{title:"\u64CD\u4F5C\u7CFB\u7EDF",align:"center",dataIndex:"os"},{title:"\u767B\u5F55\u65F6\u95F4",align:"center",search:!1,sorter:!0,dataIndex:"createTime",valueType:"dateTime"}];return(0,O.jsx)(P.Z,{tableProps:{columns:I,request:_}})},M=a},62586:function(B,y,e){"use strict";e.d(y,{W:function(){return T}});var T=function(r,f){r||(r=74);var m=null;if(f){var E;m=document.getElementById(f)?(E=document.getElementById(f))===null||E===void 0?void 0:E.getElementsByClassName("ant-table-thead")[0]:null}else m=document.getElementsByClassName("ant-table-thead")[0];var _=0;m&&(_=m.getBoundingClientRect().bottom);var p="calc(100vh - ".concat(_+r+window.scrollY+30,"px)");return p}}}]);
