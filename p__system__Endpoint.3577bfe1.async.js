(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[592],{33107:function(ie,U,t){"use strict";var f=t(86582),T=t(2824),P=t(67294),h=t(6934),j=t(60171),u=t(24557),d=t(49e3),W=t(50208),M=t(45254),K=t(90102),E=t(85893),S=function l(s){var i=[];return Array.isArray(s)&&(s==null||s.forEach(function(e){var v={};e.id==="0"?v.icon=(0,E.jsx)(u.Z,{}):v.icon=(0,E.jsx)(d.Z,{}),v.key=e.id,v.value=e.id,v.name=e.name,v.title=e.name,v.deptTypeId=e.typeId,v.children=e.children?l(e.children):[],i.push(v)})),i},c=function l(s,i){for(var e,v=0;v<i.length;v++){var n=i[v];n.children&&(n.children.some(function(O){return O.key===s})?e=n.key:l(s,n.children)&&(e=l(s,n.children)))}return e},g=function(s){var i=(0,W.tT)("@@initialState"),e=i.initialState,v=e||{},n=v.currentUser,O=(0,P.useState)(n==null?void 0:n.deptId),L=(0,T.Z)(O,2),z=L[0],N=L[1],w=(0,P.useState)({id:n==null?void 0:n.deptId,name:n==null?void 0:n.deptName,typeId:n==null?void 0:n.deptTypeId}),$=(0,T.Z)(w,2),I=$[0],Q=$[1],J=(0,P.useState)(),re=(0,T.Z)(J,2),Y=re[0],oe=re[1],G=(0,P.useState)([]),ne=(0,T.Z)(G,2),B=ne[0],V=ne[1],X=(0,P.useState)([n==null?void 0:n.deptId]),ae=(0,T.Z)(X,2),ue=ae[0],H=ae[1],fe=(0,P.useState)(""),de=(0,T.Z)(fe,2),le=de[0],x=de[1],pe=(0,P.useState)(!0),ce=(0,T.Z)(pe,2),he=ce[0],se=ce[1];(0,P.useEffect)(function(){me()},[]);var me=function(){K.et((0,M.Ui)("/dept/tree")).then(function(a){if(a!=null&&a.data){var b=S(a==null?void 0:a.data);oe(b),_e(a==null?void 0:a.data),s.onInit&&s.onInit(b)}})},_e=function r(a){for(var b=function(Z){var D=a[Z];V(function(R){return[].concat((0,f.Z)(R),[{key:D.id,title:D.name}])}),D.children&&r(D.children)},y=0;y<a.length;y++)b(y)},o=function(a){H(a),se(!1)},p=function(a){var b=a.target.value;if(b){var y=B==null?void 0:B.map(function(m){var Z;return((Z=String(m==null?void 0:m.title))===null||Z===void 0?void 0:Z.indexOf(b))>-1?c(m.key,Y):null}).filter(function(m,Z,D){return m&&D.indexOf(m)===Z});H(y.length>0?y:[n==null?void 0:n.deptId]),x(b),se(!0)}else H([n==null?void 0:n.deptId])},C=(0,P.useMemo)(function(){var r=function a(b){return b.map(function(y){var m=y.title,Z=m.indexOf(le),D=m.substring(0,Z),R=m.slice(Z+le.length),ve=Z>-1?(0,E.jsxs)("span",{children:[D,(0,E.jsx)("span",{style:{color:"#f50"},children:le}),R]}):(0,E.jsx)("span",{children:m}),q=y.key==="0"?(0,E.jsx)(u.Z,{}):(0,E.jsx)(d.Z,{});return y.children?{title:ve,icon:q,key:y.key,children:a(y.children)}:{title:ve,key:y.key,icon:(0,E.jsx)(u.Z,{})}})};return Y?r(Y):null},[le]);return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(h.default,{style:{marginBottom:8},placeholder:"\u90E8\u95E8\u641C\u7D22",onChange:p}),Y&&(0,E.jsx)(j.Z,{showIcon:!0,onExpand:o,blockNode:!0,expandedKeys:ue,autoExpandParent:he,style:{fontSize:"16px"},defaultSelectedKeys:[n==null?void 0:n.deptId],treeData:C||Y,selectedKeys:[z],onSelect:function(a,b){a[0]&&(N(a[0]),Q({id:b.node.key,name:b.node.title,typeId:b.node.deptTypeId}),s.onSelect(a[0]))}})]})};U.Z=g},71550:function(ie,U,t){"use strict";t.d(U,{Z:function(){return s}});var f=t(11849),T=t(93224),P=t(67294),h=t(952),j=t(37476),u=t(71975),d=t(2824),W=t(61193),M=t.n(W),K=t(85893),E=["title","modalProps","children"],S=function(e){var v=(0,P.useState)(!1),n=(0,d.Z)(v,2),O=n[0],L=n[1],z=(0,P.useState)(),N=(0,d.Z)(z,2),w=N[0],$=N[1],I=P.createRef(),Q=e.title,J=e.modalProps,re=e.children,Y=(0,T.Z)(e,E),oe=function(ne,B){var V,X=window.document.documentElement,ae=X.clientWidth,ue=X.clientHeight,H=I==null||(V=I.current)===null||V===void 0?void 0:V.getBoundingClientRect();!H||$({left:-H.left+B.x,right:ae-(H.right-B.x),top:-H.top+B.y,bottom:ue-(H.bottom-B.y)})};return(0,K.jsx)(j.Y,(0,f.Z)((0,f.Z)({title:(0,K.jsx)("div",{style:{width:"100%",cursor:"move"},onMouseOver:function(){O&&L(!1)},onMouseOut:function(){L(!0)},onFocus:function(){},onBlur:function(){},children:Q})},Y),{},{modalProps:{modalRender:function(ne){return(0,K.jsx)(M(),{disabled:O,bounds:w,onStart:function(V,X){return oe(V,X)},children:(0,K.jsxs)("div",{ref:I,children:[" ",ne," "]})})}},children:re}))},c=S,g=["formType","isAdd","children","title"],l=function(e){var v={ProForm:h.ZP,YuDraggleModal:c,ModalForm:j.Y,DrawerForm:u.a},n=e==null?void 0:e.layout;n=n||"horizontal";var O=n==="horizontal"?{labelCol:{span:5},wrapperCol:{span:19}}:{},L=e!=null&&e.formType?v[e==null?void 0:e.formType]:v.YuDraggleModal,z=e.formType,N=e.isAdd,w=e.children,$=e.title,I=(0,T.Z)(e,g);return(0,K.jsx)(L,(0,f.Z)((0,f.Z)((0,f.Z)({title:$,layout:n},O),I),{},{children:w}))},s=l},35468:function(ie,U,t){"use strict";var f=t(11849),T=t(2824),P=t(40759),h=t(57895),j=t(78009),u=t(33107),d=t(67294),W=t(62586),M=t(85893);function K(E){var S=(0,d.useState)(),c=(0,T.Z)(S,2),g=c[0],l=c[1],s=(0,d.useState)(),i=(0,T.Z)(s,2),e=i[0],v=i[1],n=(0,d.useRef)(),O=(0,d.useState)(""),L=(0,T.Z)(O,2),z=L[0],N=L[1];(0,d.useEffect)(function(){N((0,W.W)())},[]);var w=E.showDeptTree===void 0?!0:E.showDeptTree;return(0,M.jsx)(j.ZP,{header:{breadcrumb:{}},children:(0,M.jsxs)(h.ZP,{split:"vertical",ghost:!0,children:[w&&(0,M.jsx)(h.ZP,{style:{height:"calc(100vh - 168px)",background:"white"},colSpan:{xs:12,sm:12,md:10,lg:8,xl:5},children:(0,M.jsx)(u.Z,{onInit:function(I){v(I)},onSelect:function(I){if(l(I),E.tableProps.actionRef){var Q;(Q=E.tableProps.actionRef.current)===null||Q===void 0||Q.reload()}else{var J;(J=n.current)===null||J===void 0||J.reload()}}})}),(0,M.jsx)(h.ZP,{ghost:!0,children:(0,M.jsx)(P.ZP,(0,f.Z)({tableLayout:"fixed",rowKey:"id",search:{labelWidth:120,onCollapse:function(){N((0,W.W)())}},actionRef:n,params:(0,f.Z)({deptId:g},E.tableProps.params),scroll:{y:z,x:"1000px"},pagination:{showSizeChanger:!0}},E.tableProps))})]})})}U.Z=K},98435:function(ie,U,t){"use strict";t.r(U),t.d(U,{default:function(){return _e},methodMap:function(){return se}});var f=t(11849),T=t(57663),P=t(71577),h=t(62350),j=t(24565),u=t(39428),d=t(3182),W=t(77576),M=t(12028),K=t(71153),E=t(60331),S=t(2824),c=t(67294),g=t(49101),l=t(90102),s=t(45254),i=(0,s.Ui)("/endpoint");function e(o,p){return v.apply(this,arguments)}function v(){return v=(0,d.Z)((0,u.Z)().mark(function o(p,C){return(0,u.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",l.LV("".concat(i),p,C));case 1:case"end":return a.stop()}},o)})),v.apply(this,arguments)}function n(o,p){return O.apply(this,arguments)}function O(){return O=(0,d.Z)((0,u.Z)().mark(function o(p,C){return(0,u.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",l.FO(p,i).then(function(b){return C(b)}));case 1:case"end":return a.stop()}},o)})),O.apply(this,arguments)}function L(o){return z.apply(this,arguments)}function z(){return z=(0,d.Z)((0,u.Z)().mark(function o(p){return(0,u.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",l.Vx(i,p));case 1:case"end":return r.stop()}},o)})),z.apply(this,arguments)}function N(o){return w.apply(this,arguments)}function w(){return w=(0,d.Z)((0,u.Z)().mark(function o(p){return(0,u.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",l.IH(p,i));case 1:case"end":return r.stop()}},o)})),w.apply(this,arguments)}function $(o){return I.apply(this,arguments)}function I(){return I=(0,d.Z)((0,u.Z)().mark(function o(p){return(0,u.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",l.Jp(p,i));case 1:case"end":return r.stop()}},o)})),I.apply(this,arguments)}function Q(o){return J.apply(this,arguments)}function J(){return J=(0,d.Z)((0,u.Z)().mark(function o(p){return(0,u.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",l.Vx("".concat(i,"/").concat(p,":accessEnable")));case 1:case"end":return r.stop()}},o)})),J.apply(this,arguments)}function re(o){return Y.apply(this,arguments)}function Y(){return Y=(0,d.Z)((0,u.Z)().mark(function o(p){return(0,u.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",l.Vx("".concat(i,"/").concat(p,":accessDisable")));case 1:case"end":return r.stop()}},o)})),Y.apply(this,arguments)}function oe(o){return G.apply(this,arguments)}function G(){return G=(0,d.Z)((0,u.Z)().mark(function o(p){return(0,u.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",l.Vx("".concat(i,"/").concat(p,":logEnable")));case 1:case"end":return r.stop()}},o)})),G.apply(this,arguments)}function ne(o){return B.apply(this,arguments)}function B(){return B=(0,d.Z)((0,u.Z)().mark(function o(p){return(0,u.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",l.Vx("".concat(i,"/").concat(p,":logDisable")));case 1:case"end":return r.stop()}},o)})),B.apply(this,arguments)}var V=t(75159),X=t(52688),ae=t(5966),ue=t(64317),H=t(97462),fe=t(71550),de=t(96486),le=t.n(de),x=t(85893),pe=function(p){var C=(0,c.useState)(new Map),r=(0,S.Z)(C,2),a=r[0],b=r[1];return(0,c.useEffect)(function(){l.U2((0,s.Ui)("/endpoint/all")).then(function(y){b(new Map(Object.entries(le().groupBy(y,"pattern"))))})},[]),(0,x.jsxs)(fe.Z,(0,f.Z)((0,f.Z)({},p),{},{children:[(0,x.jsx)(X.Z,{name:"accessEnabled",label:"\u6743\u9650\u72B6\u6001"}),(0,x.jsx)(X.Z,{name:"logEnabled",label:"\u65E5\u5FD7\u72B6\u6001"}),(0,x.jsx)(ae.Z,{rules:[{required:!0,message:"\u7AEF\u70B9\u540D\u79F0\u4E3A\u5FC5\u586B\u9879"}],label:"\u7AEF\u70B9\u540D\u79F0",name:"label"}),(0,x.jsx)(ue.Z,{name:"pattern",label:"\u7AEF\u70B9\u8DEF\u5F84",showSearch:!0,options:Array.from(a==null?void 0:a.keys()).map(function(y){return{value:y,label:y}}),placeholder:"\u8BF7\u9009\u62E9",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u7AEF\u70B9\u8DEF\u5F84"}],fieldProps:{onChange:function(){var m,Z;(m=p.formRef)===null||m===void 0||(Z=m.current)===null||Z===void 0||Z.setFieldsValue({method:""})}}}),(0,x.jsx)(H.Z,{name:["pattern"],children:function(m){var Z,D=m.pattern;return(0,x.jsx)(ue.Z,{name:"method",label:"\u8BF7\u6C42\u65B9\u6CD5",options:a==null||(Z=a.get(D))===null||Z===void 0?void 0:Z.map(function(R){return{value:R.method,label:R.method}}),fieldProps:{defaultValue:""},placeholder:"\u8BF7\u9009\u62E9",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u8BF7\u6C42\u65B9\u6CD5"}]})}})]}))},ce=pe,he=t(35468),se={POST:{color:"blue",text:"POST"},PUT:{color:"green",text:"PUT"},GET:{color:"volcano",text:"GET"},DELETE:{color:"red",text:"DELETE"}},me=function(){var p=(0,c.useState)(!1),C=(0,S.Z)(p,2),r=C[0],a=C[1],b=(0,c.useState)(),y=(0,S.Z)(b,2),m=y[0],Z=y[1],D=(0,c.useRef)(),R=(0,c.useRef)(),ve=[{title:"\u7AEF\u70B9\u540D\u79F0",dataIndex:"label",sorter:!0},{title:"\u7AEF\u70B9\u8DEF\u5F84",dataIndex:"pattern",sorter:!0},{title:"\u8BF7\u6C42\u65B9\u6CD5",align:"center",dataIndex:"method",valueType:"select",valueEnum:{POST:{text:"POST"},PUT:{text:"PUT"},GET:{text:"GET"},DELETE:{text:"DELETE"}},render:function(ee,_){return(0,x.jsx)(E.Z,{color:se[_.method].color,children:se[_.method].text})}},{title:"\u6743\u9650",align:"center",dataIndex:"accessEnabled",valueType:"select",valueEnum:{true:{text:"\u542F\u7528"},false:{text:"\u505C\u7528"}},render:function(ee,_){return[(0,x.jsx)(M.Z,{checked:_.accessEnabled,checkedChildren:"\u542F\u7528",unCheckedChildren:"\u505C\u7528",onChange:function(){var F;_.accessEnabled?re(_.id):Q(_.id),(F=R.current)===null||F===void 0||F.reload()}},"accessEnabled")]}},{title:"\u65E5\u5FD7",align:"center",dataIndex:"logEnabled",valueType:"select",valueEnum:{true:{text:"\u542F\u7528"},false:{text:"\u505C\u7528"}},render:function(ee,_){return[(0,x.jsx)(M.Z,{checked:_.logEnabled,checkedChildren:"\u542F\u7528",unCheckedChildren:"\u505C\u7528",onChange:function(){var F;_.logEnabled?ne(_.id):oe(_.id),(F=R.current)===null||F===void 0||F.reload()}},"logEnabled")]}},{title:"\u521B\u5EFA\u65F6\u95F4",align:"center",search:!1,sorter:!0,dataIndex:"createTime",valueType:"dateTime"},{title:"\u64CD\u4F5C",align:"center",dataIndex:"option",valueType:"option",render:function(ee,_){return[(0,x.jsx)("a",{onClick:(0,d.Z)((0,u.Z)().mark(function k(){return(0,u.Z)().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,n(_.id,Z);case 2:a(!0);case 3:case"end":return A.stop()}},k)})),children:"\u7F16\u8F91"},"update"),(0,x.jsx)(j.Z,{title:"\u786E\u8BA4\u5220\u9664\u8BE5\u8BB0\u5F55\u5417?",okText:"\u662F",cancelText:"\u5426",onConfirm:(0,d.Z)((0,u.Z)().mark(function k(){return(0,u.Z)().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,V.fn($,_.id);case 2:R.current&&R.current.reload();case 3:case"end":return A.stop()}},k)})),children:(0,x.jsx)("a",{href:"#",children:"\u5220\u9664"},"delete")},"popconfirm")]}}];return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(he.Z,{showDeptTree:!1,tableProps:{actionRef:R,toolBarRender:function(){return[(0,x.jsxs)(P.Z,{type:"primary",onClick:function(){var _;D==null||(_=D.current)===null||_===void 0||_.resetFields(),Z(void 0),a(!0)},children:[(0,x.jsx)(g.Z,{})," \u65B0\u5EFA"]},"primary")]},request:e,columns:ve}}),(0,x.jsx)(ce,{width:"500px",title:m!=null&&m.id?"\u66F4\u65B0\u7AEF\u70B9":"\u65B0\u5EFA\u7AEF\u70B9",visible:r,onVisibleChange:function(ee){if(ee){var _;D==null||(_=D.current)===null||_===void 0||_.resetFields()}else a(!1),Z(void 0)},formRef:D,initialValues:m||{accessEnabled:!0,logEnabled:!1},onFinish:function(){var q=(0,d.Z)((0,u.Z)().mark(function ee(_){var k,F,A;return(0,u.Z)().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(k=(0,f.Z)((0,f.Z)({},m),_),k.id){te.next=7;break}return te.next=4,V.ii(k,N);case 4:F=te.sent,te.next=10;break;case 7:return te.next=9,V.He(k,L);case 9:F=te.sent;case 10:F&&(a(!1),D==null||(A=D.current)===null||A===void 0||A.resetFields(),R.current&&R.current.reload());case 11:case"end":return te.stop()}},ee)}));return function(ee){return q.apply(this,arguments)}}()})]})},_e=me},62586:function(ie,U,t){"use strict";t.d(U,{W:function(){return f}});var f=function(P,h){P||(P=74);var j=null;if(h){var u;j=document.getElementById(h)?(u=document.getElementById(h))===null||u===void 0?void 0:u.getElementsByClassName("ant-table-thead")[0]:null}else j=document.getElementsByClassName("ant-table-thead")[0];var d=0;j&&(d=j.getBoundingClientRect().bottom);var W="calc(100vh - ".concat(d+P+window.scrollY+30,"px)");return W}},75159:function(ie,U,t){"use strict";t.d(U,{pr:function(){return u},ii:function(){return d},He:function(){return W},fn:function(){return M}});var f=t(39428),T=t(11849),P=t(34792),h=t(48086),j=t(3182),u=function(){var S=(0,j.Z)((0,f.Z)().mark(function c(g,l){var s,i,e=arguments;return(0,f.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=e.length>2&&e[2]!==void 0?e[2]:"\u5904\u7406",i=h.ZP.loading("\u6B63\u5728".concat(s)),n.prev=2,i(),n.next=6,l((0,T.Z)({},g));case 6:return h.ZP.success("".concat(s,"\u6210\u529F")),n.abrupt("return",!0);case 10:return n.prev=10,n.t0=n.catch(2),h.ZP.error("".concat(s,"\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01")),n.abrupt("return",!1);case 14:case"end":return n.stop()}},c,null,[[2,10]])}));return function(g,l){return S.apply(this,arguments)}}(),d=function(){var S=(0,j.Z)((0,f.Z)().mark(function c(g,l){var s;return(0,f.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=h.ZP.loading("\u6B63\u5728\u6DFB\u52A0"),e.prev=1,s(),e.next=5,l((0,T.Z)({},g));case 5:return h.ZP.success("\u6DFB\u52A0\u6210\u529F"),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(1),h.ZP.error("\u6DFB\u52A0\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01"),e.abrupt("return",!1);case 13:case"end":return e.stop()}},c,null,[[1,9]])}));return function(g,l){return S.apply(this,arguments)}}(),W=function(){var S=(0,j.Z)((0,f.Z)().mark(function c(g,l){var s;return(0,f.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=h.ZP.loading("\u6B63\u5728\u66F4\u65B0"),e.prev=1,s(),e.next=5,l((0,T.Z)({},g));case 5:return h.ZP.success("\u66F4\u65B0\u6210\u529F"),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(1),h.ZP.error("\u66F4\u65B0\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01"),e.abrupt("return",!1);case 13:case"end":return e.stop()}},c,null,[[1,9]])}));return function(g,l){return S.apply(this,arguments)}}(),M=function(){var S=(0,j.Z)((0,f.Z)().mark(function c(g,l){var s;return(0,f.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=h.ZP.loading("\u6B63\u5728\u5220\u9664"),l){e.next=3;break}return e.abrupt("return",!0);case 3:return e.prev=3,s(),e.next=7,g(l);case 7:return h.ZP.success("\u5220\u9664\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"),e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(3),h.ZP.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),e.abrupt("return",!1);case 15:case"end":return e.stop()}},c,null,[[3,11]])}));return function(g,l){return S.apply(this,arguments)}}(),K=null,E=null}}]);
