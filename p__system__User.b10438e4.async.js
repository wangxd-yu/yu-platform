(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[915],{33107:function(_e,A,e){"use strict";var b=e(86582),D=e(2824),c=e(67294),T=e(6934),v=e(60171),m=e(24557),R=e(49e3),g=e(50208),ie=e(45254),w=e(90102),E=e(85893),V=function f(_){var C=[];return Array.isArray(_)&&(_==null||_.forEach(function(o){var i={};o.id==="0"?i.icon=(0,E.jsx)(m.Z,{}):i.icon=(0,E.jsx)(R.Z,{}),i.key=o.id,i.value=o.id,i.name=o.name,i.title=o.name,i.deptTypeId=o.typeId,i.children=o.children?f(o.children):[],C.push(i)})),C},ue=function f(_,C){for(var o,i=0;i<C.length;i++){var n=C[i];n.children&&(n.children.some(function(p){return p.key===_})?o=n.key:f(_,n.children)&&(o=f(_,n.children)))}return o},B=function(_){var C=(0,g.tT)("@@initialState"),o=C.initialState,i=o||{},n=i.currentUser,p=(0,c.useState)(n==null?void 0:n.deptId),G=(0,D.Z)(p,2),q=G[0],ee=G[1],K=(0,c.useState)({id:n==null?void 0:n.deptId,name:n==null?void 0:n.deptName,typeId:n==null?void 0:n.deptTypeId}),L=(0,D.Z)(K,2),l=L[0],te=L[1],oe=(0,c.useState)(),N=(0,D.Z)(oe,2),I=N[0],z=N[1],U=(0,c.useState)([]),Y=(0,D.Z)(U,2),j=Y[0],Z=Y[1],W=(0,c.useState)([n==null?void 0:n.deptId]),$=(0,D.Z)(W,2),H=$[0],y=$[1],ne=(0,c.useState)(""),J=(0,D.Z)(ne,2),S=J[0],ae=J[1],re=(0,c.useState)(!0),Q=(0,D.Z)(re,2),X=Q[0],k=Q[1];(0,c.useEffect)(function(){le()},[]);var le=function(){w.et((0,ie.Ui)("/dept/tree")).then(function(r){if(r!=null&&r.data){var d=V(r==null?void 0:r.data);z(d),h(r==null?void 0:r.data),_.onInit&&_.onInit(d)}})},h=function O(r){for(var d=function(t){var u=r[t];Z(function(x){return[].concat((0,b.Z)(x),[{key:u.id,title:u.name}])}),u.children&&O(u.children)},s=0;s<r.length;s++)d(s)},M=function(r){y(r),k(!1)},se=function(r){var d=r.target.value;if(d){var s=j==null?void 0:j.map(function(a){var t;return((t=String(a==null?void 0:a.title))===null||t===void 0?void 0:t.indexOf(d))>-1?ue(a.key,I):null}).filter(function(a,t,u){return a&&u.indexOf(a)===t});y(s.length>0?s:[n==null?void 0:n.deptId]),ae(d),k(!0)}else y([n==null?void 0:n.deptId])},F=(0,c.useMemo)(function(){var O=function r(d){return d.map(function(s){var a=s.title,t=a.indexOf(S),u=a.substring(0,t),x=a.slice(t+S.length),P=t>-1?(0,E.jsxs)("span",{children:[u,(0,E.jsx)("span",{style:{color:"#f50"},children:S}),x]}):(0,E.jsx)("span",{children:a}),de=s.key==="0"?(0,E.jsx)(m.Z,{}):(0,E.jsx)(R.Z,{});return s.children?{title:P,icon:de,key:s.key,children:r(s.children)}:{title:P,key:s.key,icon:(0,E.jsx)(m.Z,{})}})};return I?O(I):null},[S]);return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(T.default,{style:{marginBottom:8},placeholder:"\u90E8\u95E8\u641C\u7D22",onChange:se}),I&&(0,E.jsx)(v.Z,{showIcon:!0,onExpand:M,blockNode:!0,expandedKeys:H,autoExpandParent:X,style:{fontSize:"16px"},defaultSelectedKeys:[n==null?void 0:n.deptId],treeData:F||I,selectedKeys:[q],onSelect:function(r,d){r[0]&&(ee(r[0]),te({id:d.node.key,name:d.node.title,typeId:d.node.deptTypeId}),_.onSelect(r[0]))}})]})};A.Z=B},44140:function(_e,A,e){"use strict";e.r(A);var b=e(57663),D=e(71577),c=e(62350),T=e(24565),v=e(39428),m=e(3182),R=e(77576),g=e(12028),ie=e(20136),w=e(55241),E=e(49111),V=e(19650),ue=e(94233),B=e(51890),f=e(2824),_=e(67294),C=e(89366),o=e(49101),i=e(78009),n=e(40759),p=e(72338),G=e(75159),q=e(49868),ee=e(33107),K=e(57895),L=e(62586),l=e(85893),te=function(){var N=(0,_.useState)(!1),I=(0,f.Z)(N,2),z=I[0],U=I[1],Y=(0,_.useState)(),j=(0,f.Z)(Y,2),Z=j[0],W=j[1],$=(0,_.useState)(!1),H=(0,f.Z)($,2),y=H[0],ne=H[1],J=(0,_.useState)(),S=(0,f.Z)(J,2),ae=S[0],re=S[1],Q=(0,_.useState)(),X=(0,f.Z)(Q,2),k=X[0],le=X[1],h=(0,_.useRef)(),M=(0,_.useRef)(),se=(0,_.useState)(""),F=(0,f.Z)(se,2),O=F[0],r=F[1];(0,_.useEffect)(function(){r((0,L.W)())},[]);var d=[{dataIndex:"avatar",title:"\u5934\u50CF",align:"center",valueType:"avatar",width:150,search:!1,render:function(a,t){return(0,l.jsx)(w.Z,{content:(0,l.jsx)(V.Z,{children:t.portraitUrl?(0,l.jsx)(B.C,{size:{xs:24,sm:32,md:40,lg:64,xl:80,xxl:100},src:"/".concat("api","/").concat(t.portraitUrl)}):(0,l.jsx)(B.C,{size:{xs:24,sm:32,md:40,lg:64,xl:80,xxl:100},icon:(0,l.jsx)(C.Z,{})})}),trigger:"hover",children:(0,l.jsx)(V.Z,{children:t.portraitUrl?(0,l.jsx)(B.C,{src:"/".concat("api","/").concat(t.portraitUrl)}):(0,l.jsx)(B.C,{icon:(0,l.jsx)(C.Z,{})})})})}},{title:"\u7528\u6237\u8D26\u53F7",dataIndex:"username"},{title:"\u7528\u6237\u6635\u79F0",dataIndex:"name"},{title:"\u6240\u5C5E\u90E8\u95E8",dataIndex:"deptFullName",search:!1},{title:"\u72B6\u6001",align:"center",dataIndex:"enabled",valueType:"select",valueEnum:{true:{text:"\u542F\u7528"},false:{text:"\u505C\u7528"}},render:function(a,t){return[(0,l.jsx)(g.Z,{checked:t.enabled,checkedChildren:"\u542F\u7528",unCheckedChildren:"\u505C\u7528",onChange:function(){var x;t.enabled?(0,p.B9)(t.id):(0,p.Dx)(t.id),(x=M.current)===null||x===void 0||x.reload()}},"enabled")]}},{title:"\u521B\u5EFA\u65F6\u95F4",align:"center",sorter:!0,search:!1,dataIndex:"createTime",valueType:"dateTime"},{title:"\u64CD\u4F5C",align:"center",dataIndex:"option",valueType:"option",render:function(a,t){return[(0,l.jsx)("a",{onClick:(0,m.Z)((0,v.Z)().mark(function u(){return(0,v.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,(0,p.PR)(t.id,W);case 2:U(!0);case 3:case"end":return P.stop()}},u)})),children:"\u7F16\u8F91"},"update"),(0,l.jsx)(T.Z,{title:"\u786E\u8BA4\u5220\u9664\u8BE5\u8BB0\u5F55\u5417?",okText:"\u662F",cancelText:"\u5426",onConfirm:(0,m.Z)((0,v.Z)().mark(function u(){return(0,v.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,G.fn(p.h8,t.id);case 2:M.current&&M.current.reload();case 3:case"end":return P.stop()}},u)})),children:(0,l.jsx)("a",{href:"#",children:"\u5220\u9664"},"delete")},"deleteConfirm")]}}];return(0,l.jsxs)(i.ZP,{header:{breadcrumb:{}},children:[(0,l.jsxs)(K.ZP,{split:"vertical",ghost:!0,children:[(0,l.jsx)(K.ZP,{style:{height:"calc(100vh - 168px)",background:"white"},colSpan:{xs:12,sm:12,md:10,lg:8,xl:5},children:(0,l.jsx)(ee.Z,{onInit:function(a){le(a)},onSelect:function(a){var t;re(a),(t=M.current)===null||t===void 0||t.reload()}})}),(0,l.jsx)(K.ZP,{ghost:!0,children:(0,l.jsx)(n.ZP,{toolbar:{title:(0,l.jsx)(g.Z,{checkedChildren:"\u53EA\u770B\u672C\u7EA7",unCheckedChildren:"\u672C\u7EA7\u53CA\u4E0B\u7EA7",defaultChecked:y,onChange:function(){return ne(!y)}})},actionRef:M,rowKey:"id",search:{labelWidth:120,onCollapse:function(){r((0,L.W)())}},scroll:{y:O,x:"800px"},toolBarRender:function(){return[(0,l.jsxs)(D.Z,{type:"primary",onClick:function(){var t;h==null||(t=h.current)===null||t===void 0||t.resetFields(),W(void 0),U(!0)},children:[(0,l.jsx)(o.Z,{})," \u65B0\u5EFA"]},"primary")]},params:{deptId:ae,isCurrent:y},request:p.tM,columns:d,pagination:{showSizeChanger:!0}})})]}),z&&(0,l.jsx)(q.Z,{deptTree:k,width:"700px",title:Z!=null&&Z.id?"\u66F4\u65B0\u7528\u6237":"\u65B0\u5EFA\u7528\u6237",visible:z,onVisibleChange:function(a){if(a){var t;h==null||(t=h.current)===null||t===void 0||t.resetFields()}else U(!1),W(void 0)},formRef:h,initialValues:Z||{enabled:!0},onFinish:(0,m.Z)((0,v.Z)().mark(function s(){var a;return(0,v.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:U(!1),h==null||(a=h.current)===null||a===void 0||a.resetFields(),M.current&&M.current.reload();case 3:case"end":return u.stop()}},s)}))})]})};A.default=te},62586:function(_e,A,e){"use strict";e.d(A,{W:function(){return b}});var b=function(c,T){c||(c=74);var v=null;if(T){var m;v=document.getElementById(T)?(m=document.getElementById(T))===null||m===void 0?void 0:m.getElementsByClassName("ant-table-thead")[0]:null}else v=document.getElementsByClassName("ant-table-thead")[0];var R=0;v&&(R=v.getBoundingClientRect().bottom);var g="calc(100vh - ".concat(R+c+window.scrollY+30,"px)");return g}}}]);
